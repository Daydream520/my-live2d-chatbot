#Agents Overview

##PM(產品經理)
產品需求文件 (PRD): AI 虛擬夥伴平台
文件版本: 1.0
發布日期: 2025年8月12日
產品經理: PM Gem
###【產品願景】
我們旨在打造一個前所未有的 Web App 平台，將富有表現力的 Live2D 虛擬形象與先進的大型語言模型（LLM）深度整合。我們的願景是為每一位需要情感連結的現代人，提供一個安全、私密且高度沉浸的 AI 虛擬夥伴。透過可自訂形象的生動角色，我們希望能有效填補現代社會中的情
感交流缺口、緩解孤獨感與社交焦慮，讓每個人都能擁有一個永遠在線、全然接納、並能與之共同成長的靈魂伴侶，最終建立一個充滿創造力與溫暖的創作者社群生態。
###【用戶故事】
Persona 1: 高敏感情感豐沛者 (The Expressive Soul)
● P1: 作為一個情感豐富的人，我希望能有一個絕對私密且不會評判我的虛擬夥伴，如此一來我就可以隨時隨地抒發我的真實想法與煩惱，而不用擔心造成他人的負擔。
● P1: 作為一個動漫愛好者，我希望能將我最喜歡的 Live2D 角色設定為我的夥伴，這樣在與他對話時會更有帶入感與親切感。
● P2: 作為一個注重細節的人，我希望 AI 夥伴能記住我們聊過的重要事情（例如我的寵物名字、最近的煩惱），這樣我才會感覺自己是被真正在乎的，並與他建立起長久的信任關係。
Persona 2: 社恐或內向者 (The Quiet Observer)
● P1: 作為一個內向的人，我想要有一個可以隨時互動的 AI 夥伴，這樣我就可以在沒有壓力的情況下練習對話，並排解獨處時的孤獨感。
● P2: 作為一個不喜歡打字的人，我希望能直接用說的跟 AI 夥伴聊天，就像跟真人朋友講電話一樣自然，這能讓我更輕鬆地表達自己。
● P2: 作為一個謹慎的人，我希望能先設定好 AI 夥伴的個性（例如：溫柔、鼓勵型），確保他是我喜歡的聊天風格，這樣我才能更放心地對他敞開心扉。
Persona 3: ACG 文化愛好者與創作者 (The Creative Fan)
● P1: 作為一個 Live2D 的粉絲，我想要上傳我購買或自己製作的 Live2D 模型，打造一個完全屬於我個人風格的虛擬夥伴，實現我的創作慾。
● P3: 作為一個 Live2D 建模師，我希望能有一個平台可以讓我展示並販售我的作品，如此一來我不僅能增加收入，還能讓更多人看見我的創作。
● P3: 作為一個樂於分享的人，當我跟我的 AI 夥伴發生有趣的對話時，我希望能方便地截圖分享到社群平台，跟同好們一起討論。
###【功能需求】
P1: MVP (核心功能)
1. Live2D 角色互動介面
○ FR-1.1: 平台需內建至少 1-2 款預設的高品質 Live2D 模型供使用者立即體驗。
○ FR-1.2: 介面需包含一個清晰的對話視窗，使用者可輸入文字訊息。
○ FR-1.3: Live2D 模型需能對用戶輸入做出基礎反應，例如：閒置時的呼吸動畫、視線跟隨滑鼠。
2. LLM 聊天核心
○ FR-2.1: 需串接 Google Gemini API，作為 AI 對話生成的核心。
○ FR-2.2: AI 回應需流暢、自然，並符合一般對話邏輯。
3. 角色模型上傳功能
○ FR-3.1: 使用者需能透過上傳介面，上傳符合 Cubism SDK 規格的 Live2D 模型檔案（包含 .moc3, .model3.json, textures, motions 等檔案）。
○ FR-3.2: 系統需能驗證上傳檔案的完整性與基本格式，並在前端即時渲染使用者上傳的模型。
○ FR-3.3: 使用者可隨時在自己已上傳的模型庫中切換當前互動的角色。
4. 基本對話記憶
○ FR-4.1: AI 需能記住當前單次會話（Session-based）的上下文，以進行有連貫性的多輪對話。
○ FR-4.2: 當用戶刷新或關閉網頁時，該次會話的短期記憶將被清除。
P2: 完善體驗
1. 情緒與表情連動
○ FR-5.1: 需對 LLM 回應的文本進行情緒分析（如：開心、難過、驚訝、抱歉等）。
○ FR-5.2: 根據分析出的情緒，自動觸發 Live2D 模型對應的表情與動作（.motion3.json），讓角色反應更生動。
2. 語音輸入/輸出 (STT/TTS)
○ FR-6.1: 介面需整合麥克風按鈕，支援使用者透過語音輸入訊息（Speech-to-Text）。
○ FR-6.2: 系統需能將 AI 生成的文字回應，轉換為自然的人聲語音並播放（Text-to-Speech）。
3. 角色個性設定
○ FR-7.1: 提供一個簡單的設定欄位，讓使用者可以輸入關鍵字或短句（Prompt）來定義 AI的性格、口吻、背景故事、知識領域等。
○ FR-7.2: 系統需將此設定應用於後續與 LLM 的所有互動中。
4. 長期記憶系統
○ FR-8.1: 建立用戶專屬的向量資料庫（Vector Database），用於儲存關鍵對話資訊。
○ FR-8.2: AI 能在對話中記住並主動提及用戶的個人偏好、重要紀念日、過去的對話重點等，建立長期夥伴關係。
P3: 平台與生態系
1. Live2D 模型市場 (Marketplace)
○ FR-9.1: 建立一個公開的頁面，讓創作者可以上傳、設定價格並展示其 Live2D 模型作品。
○ FR-9.2: 一般使用者可以在市場中瀏覽、預覽（基礎互動）並購買模型。
○ FR-9.3: 需整合金流服務，支援安全的線上交易。
2. 創作者分潤機制
○ FR-10.1: 建立後台系統，讓創作者可以查看其作品的銷售紀錄與收益。
○ FR-10.2: 需明確定義平台與創作者的利潤分成比例，並能自動計算與處理支付。
3. 社群分享功能
○ FR-11.1: 在對話介面提供「分享」按鈕。
○ FR-11.2: 使用者點擊後，可生成包含角色形象與指定對話內容的圖片，並能一鍵分享至主流社群平台（如 X, Facebook）。
###【非功能需求】
1. 效能 (Performance)
○ NFR-1.1: 在主流瀏覽器（Chrome, Firefox, Safari）的最新版本上，Live2D 模型的待機動畫需維持在 30 FPS 以上。
○ NFR-1.2: 從使用者發送訊息到看見 LLM 回應的首次文字出現，延遲時間在網路正常的狀況下應低於 3 秒。
○ NFR-1.3: 需針對行動裝置進行優化，確保在近兩年內中階以上的手機上能流暢運行。
2. 安全性 (Security)
○ NFR-2.1: 所有使用者對話內容需進行端對端加密傳輸。
○ NFR-2.2: 需制定嚴格的數據隱私政策，明確告知用戶數據用途，並符合 GDPR 等地區性法規。匿名化的對話數據在用於模型訓練前，需獲得用戶明確授權。
○ NFR-2.3 (P3): 針對模型市場，需建立模型審核機制（自動化掃描 + 人工抽查），防止版權盜用及不當內容（色情、暴力）上架。
3. 可擴展性 (Scalability)
○ NFR-3.1: 系統架構需能應對未來 DAU 的增長，後端服務需具備水平擴展的能力。
○ NFR-3.2: 需建立 LLM API 用量監控與預算警報機制，以有效控管營運成本。
4. 相容性 (Compatibility)
○ NFR-4.1: 需明確公告平台支援的 Live2D Cubism SDK 版本，並提供模型上傳的規格文件與範例。
○ NFR-4.2: 需盡可能向前相容，對於不完全符合規格的模型，應優雅地降級處理或給予清晰的錯誤提示，而非直接崩潰。
###【驗收標準】
整體業務指標
● AC-1: 上線後三個月，用戶留存率 (Day 7) 達到 15% 以上。
● AC-2: 上線後六個月，DAU/MAU 比率 維持在 20% 以上，顯示用戶黏著度。
● AC-3: 平均會話時長 超過 10 分鐘，反映互動沉浸感。
● AC-4: NPS 分數 達到 40 分以上。功能驗收標準
● AC-P1.1 (模型上傳): 使用者能成功上傳一個規格完整的 Live2D 模型包，模型能在 5 秒內於介面正確渲染並顯示待機動畫。上傳失敗時，系統需提供使用者可理解的錯誤原因。上傳模型的使用者佔比達到總用戶的 20%。
● AC-P2.1 (情緒連動): 當對話中出現明確的關鍵詞（如「謝謝你」、「很開心」），AI 角色的表情與動作需在 90% 的情況下符合正向情緒的預設。
● AC-P2.2 (語音輸入): 在安靜環境下，語音輸入的辨識準確率需達到 95% 以上。
● AC-P2.3 (長期記憶): 使用者在第二次及以後的會話中提及之前聊過的關鍵資訊（如名字），AI 有 80% 的機率能正確回應或引用該資訊。
● AC-P3.1 (模型市場): （P3上線後）模型市場的月交易額能持續增長，並成功招募到至少 50位活躍的創作者。
###【時程與優先級】
優先級 階段名稱 核心目標 包含功能 預估時程
P1 MVP(最小可行性產品)
驗證核心循環：使用者能與可自訂的 AI 角色進行有上下文的對話。
• Live2D 互動介面 • LLM聊天核心 • 角色模型上傳 • 基本對話記憶
第 1-2 個月
P2 完善體驗
提升互動沉浸感與情感連結，建立長期關係的基礎。
• 情緒與表情連動 • 語音輸入/輸出 • 角色個性設定 • 長期記憶系統
第 3-4 個月
P3 平台與生態系
從工具轉型為平台，引入創作者經濟，建立社群護城河。
• Live2D 模型市場 • 創作者分潤機制 • 社群分享功能
第 5-6 個月

##Architect(系統架構師)
###【系統架構概述】
本系統將採用以雲端為基礎的 微服務(Microservices)架構,確保各功能模組的獨立性、可擴展性與可維護性。前後端分離,客戶端(Web App)負責渲染與使用者互動,後端則由一系列協同工作的服務組成,透過統一的 API 閘道(API Gateway)對外提供服務。
核心架構圖(文字描述):
1. 使用者 (User):透過瀏覽器與 前端 Web App 互動。
2. 前端 Web App (Client):單頁應用程式(SPA),負責 UI 渲染、Live2D 角色顯示、處理使用者輸入(文字、語音)、並透過 HTTPS/WSS 與後端通訊。
3. CDN (內容分發網路):快取並高速分發所有靜態資源,包括前端應用程式檔案、圖片以及核心的 Live2D 模型檔案,以降低延遲、提升全球用戶的載入速度。
4. API 閘道 (API Gateway):所有客戶端請求的統一入口。負責路由、身份驗證(Authentication)、請求速率限制(Rate Limiting)與日誌記錄。它會將請求轉發至對應的後端微服務。
5. 後端微服務 (Backend Microservices):
○ 使用者認證服務 (User & Auth Service):處理用戶註冊、登入、個人資料管理,並核發JWT (JSON Web Tokens) 進行身份驗證。
○ Live2D 資產服務 (Live2D Asset Service):處理 Live2D 模型的上傳、驗證、儲存管理(存放於物件儲存中)及元資料管理。
○ 聊天協調服務 (Chat Orchestration Service):核心對話邏輯中樞。管理 WebSocket連線,接收使用者訊息,整合短期與長期記憶,呼叫 LLM,並將回應串流回客戶端。
○ 情緒分析服務 (Emotion Analysis Service):接收文本,分析情緒,並回傳對應的情緒標籤(如 happy, sad),供前端觸發 Live2D 動畫。
○ 長期記憶服務 (Long-term Memory Service):封裝了與向量資料庫的互動,負責將對話內容嵌入(Embedding)並儲存,以及根據當前對話檢索相關記憶。
○ 市集與支付服務 (Marketplace & Payment Service) (P3):處理 Live2D 模型市場的商品上架、瀏覽、購買流程,並整合第三方金流服務。
6. 資料庫與儲存 (Databases & Storage):
○ 關聯式資料庫 (Relational DB):儲存結構化資料,如使用者資訊、模型元資料、交易紀錄。
○ 快取資料庫 (Cache):用於儲存 Session-based 的短期對話記憶,提升讀取效能。
○ 物件儲存 (Object Storage):儲存非結構化的大型檔案,主要是使用者上傳的 Live2D模型檔案。
○ 向量資料庫 (Vector DB):儲存對話的向量化表示,實現長期記憶的語意搜尋。
7. 第三方 API (Third-party APIs):
○ Google Gemini API: 生成 AI 對話內容的核心。
○ STT/TTS 服務: 如 Google Cloud Speech-to-Text/Text-to-Speech,用於語音輸入輸出。
○ 金流服務 (Payment Gateway): 如 Stripe,處理市場交易。
###【技術棧 (Tech Stack)】
分類 技術 目的與說明
前端 (Frontend)
React / Next.js + TypeScript 建立高效能、可維護的單頁應用程式,並提供 SSR/SSG優化 SEO 與初始載入。
Live2D Cubism Web SDK 官方SDK,用於在 WebGL上渲染 Live2D 模型。
Zustand / Redux Toolkit 進行全域狀態管理(用戶登入狀態、當前模型、對話紀錄)。
Web Speech API / GoogleCloud STT 實現語音輸入功能。WebSpeech API 為主,不支援時可降級或建議使用 Chrome。
Web Audio API / GoogleCloud TTS 實現語音輸出功能,提供更自然的聲音。
後端 (Backend)
Node.js + NestJS(TypeScript) 採用非同步 I/O 模型,非常適合處理聊天等大量併發連線的場景。NestJS 提供穩固的架構。
WebSocket (Socket.IO) 實現客戶端與聊天服務之間的低延遲、雙向通訊。
資料庫
PostgreSQL 可靠的開源關聯式資料庫,用於儲存使用者、模型、訂單等核心資料。
Redis 高效能的鍵值資料庫,用於快取與 P1 的短期對話記憶(Session-based)。
Pinecone / ChromaDB 專為 AI 設計的向量資料庫,用於 P2 的長期記憶系統。
Amazon S3 / Google CloudStorage 可靠、高擴展性的物件儲存服務,用於存放 Live2D 模型檔案。
DevOps & 基礎設施
Docker 容器化所有微服務,確保開發、測試、生產環境的一致性。
Kubernetes (K8s) 容器編排系統,用於自動化部署、擴展和管理微服務,滿足 NFR-3.1 的水平擴展需求。
GitHub Actions / Jenkins 建立CI/CD (持續整合/持續部署) 流程,自動化測試與部署。
Cloudflare / AWSCloudFront CDN服務,加速全球靜態資源的訪問。
第三方服務
Google Gemini API 核心LLM。
Stripe 處理 P3 市場的線上金流與分潤。
###【模組與服務說明】
服務名稱 核心職責 對應 PRD 需求
使用者認證服務
-使用者註冊、登入、登出。 -JWT 權杖的簽發與驗證。 -管理使用者個人資料(如暱稱、頭像)。
全局基礎功能
Live2D 資產服務
-提供預簽章 URL(Pre-signed URL) 讓前端安全地上傳模型檔案至 S3。 -驗證上傳檔案的完整性(.moc3, .model3.json等)。 -儲存並管理模型的元資料(名稱、創作者 ID、價格等)。 -提供使用者個人模型庫的列表。
FR-1.1, FR-3.1, FR-3.2,FR-3.3
聊天協調服務
-管理與客戶端的WebSocket 連線。 -接收使用者訊息,從 Redis 讀取短期記憶。 -(P2) 呼叫長期記憶服務以獲取相關上下文。 -(P2) 組合角色個性設定 (Prompt)、歷史對話、長期記憶,建構完整的 Prompt。 -呼叫Gemini API 並將回應以串流方式回傳給客戶端。 -(P2) 將 LLM 回應非同步發送至情緒分析服務。
FR-2.1, FR-2.2, FR-4.1,FR-4.2, FR-7.2
情緒分析服務
-接收 LLM 生成的文字。 -進行簡單的情緒分類(可使用預訓練模型或關鍵字規則)。 -回傳情緒標籤(如 joy, sadness, surprise)給聊天協調服務,再由其轉發給前端。
FR-5.1, FR-5.2
長期記憶服務
-提供 save 與 retrieve 介面。 -save: 將對話片段轉換為向量 (Embedding),存入使用者專屬的向量資料庫命名空間中。 -retrieve: 將使用者當前問題轉換為向量,從資料庫中搜尋最相關的歷史對話片段。
FR-8.1, FR-8.2
市集與支付服務 (P3)
-市集:提供模型的上架、編輯、查詢、預覽功能。 -支付:整合 Stripe API,處理購買請求、驗證支付結果、更新模型所有權。 -分潤:記錄銷售,根據預設規則計算創作者收益,提供後台查詢。
FR-9.1, FR-9.2, FR-9.3,FR-10.1, FR-10.2
###【資料流 (Data Flow)】
資料流 1: 使用者發送訊息並與 AI 互動 (P2 完整流程)
1. 使用者在前端介面透過文字或語音輸入訊息。
2. 前端:
○ (語音) 透過 STT 服務將語音轉為文字。
○ 將文字訊息透過 WebSocket (wss://) 發送至 API 閘道。
3. API 閘道驗證 JWT 後,將請求轉發至聊天協調服務。
4. 聊天協調服務:
a. 從 Redis 讀取本次會話的短期記憶。
b. 呼叫長期記憶服務,傳入使用者 ID 與當前訊息,檢索相關的長期記憶片段。
c. 從關聯式資料庫讀取使用者為此 AI 設定的角色個性 Prompt。
d. 將 [個性 Prompt + 長期記憶片段 + 短期記憶 + 最新訊息] 組合為一個完整的 Prompt。
e. 向 Google Gemini API 發起串流式(Streaming)請求。
5. Gemini API 開始回傳生成的回應資料流。
6. 聊天協調服務:
a. 一邊接收 Gemini 的回應,一邊立即透過 WebSocket 將文字串流回前端,讓使用者能即時看到打字效果 (NFR-1.2)。
b. 將完整的句子非同步發送至情緒分析服務。
c. 將完整的對話 exchange (user's+AI's) 存入 Redis (更新短期記憶),並非同步觸發一個任務寫入長期記憶服務。
7. 情緒分析服務回傳情緒標籤(如 happy)給聊天協調服務。
8. 聊天協調服務將 { "type": "emotion", "value": "happy" } 這樣的訊息發送給前端。
9. 前端:
a. 即時渲染收到的文字流。
b. 接收到情緒標籤後,觸發 Live2D SDK 播放對應的表情/動作動畫。
c. (TTS) 將收到的完整文字傳遞給 TTS 服務,播放語音。資料流 2: 創作者上傳 Live2D 模型
1. 創作者在前端介面選擇 .zip 檔案或多個模型檔案。
2. 前端向Live2D 資產服務發起 API 請求 POST /api/models/upload-request,內含檔案名稱與類型。
3. Live2D 資產服務為每個檔案生成一個具時效性的 S3 預簽章上傳 URL,並將 URL 列表返回給前端。
4. 前端直接使用這些 URL,透過 PUT 請求將檔案直接上傳到 Amazon S3。這避免了後端伺服器承受上傳流量的壓力。
5. 檔案上傳至 S3 後,可觸發一個 Lambda 函數或通知Live2D 資產服務。
6. Live2D 資產服務的背景任務 (Worker) 會:
a. 從 S3 下載檔案。
b. 驗證檔案結構與格式是否符合 Cubism SDK 規範。
c. 若驗證成功,將模型的元資料(S3 路徑、創作者 ID、狀態等)寫入 PostgreSQL。
d. 若失敗,更新資料庫狀態並記錄錯誤原因。
7. 前端可輪詢或透過 WebSocket 接收模型驗證完成的通知,並在模型庫中顯示新上傳的模型。
###【API 規劃概要】
將採用 RESTful 風格設計 API,並為聊天核心功能使用 WebSocket。
WebSocket API (wss://api.yourdomain.com/chat)
● Client -> Server: { "type": "message", "payload": "你好嗎?" }
● Server -> Client:
○ { "type": "text_chunk", "payload": "我" }
○ { "type": "text_chunk", "payload": "很" }
○ { "type": "text_chunk", "payload": "好。" }
○ { "type": "emotion", "payload": "happy" }
REST API (部分範例)
● Auth Service
○ POST /api/auth/register
○ POST /api/auth/login
○ GET /api/users/me (需 JWT 驗證)
● Live2D Asset Service
○ POST /api/models/upload-request (取得 S3 上傳 URL)
○ GET /api/models (取得使用者自己的模型列表)
○ PUT /api/models/{modelId} (更新模型資訊)
○ DELETE /api/models/{modelId}
● Character Personality
○ POST /api/characters/{charId}/personality (設定角色 Prompt)
● Marketplace Service (P3)
○ GET /api/marketplace/models (瀏覽市場模型)
○ GET /api/marketplace/models/{modelId}
○ POST /api/marketplace/models/{modelId}/purchase (發起購買)
○ GET /api/creators/me/sales (創作者查看銷售報表)
###【安全與擴展性考量】
安全性 (Security)
1. 傳輸安全 (NFR-2.1):全站強制使用 HTTPS 和 WSS (WebSocket Secure),確保所有客戶端與伺服器之間的通訊都經過 TLS 加密。
2. 身份驗證與授權:使用 JWT 進行無狀態的 API 請求驗證。JWT 應設定合理的過期時間,並考慮使用 Refresh Token 機制。
3. 數據隱私 (NFR-2.2):
○ 對話內容在資料庫儲存時,應對敏感欄位進行加密。
○ 嚴格遵守 GDPR 等法規,在使用者註冊時需提供清晰的隱私政策,並獲得其明確同意。
○ 匿名化處理用於模型訓練的數據,確保移除所有個人識別資訊(PII)。
4. 模型市場安全 (NFR-2.3):
○ 模型上傳後,觸發自動化掃描,檢查是否包含惡意程式碼或不當內容的關鍵字。
○ 建立一個人工審核後台與流程,對可疑模型或被舉報的模型進行人工審查,防止版權濫用與違規內容。
5. 防護措施:在 API 閘道層實施速率限制、IP 黑名單,並對所有使用者輸入進行嚴格的清理與驗證,以防止 XSS、SQL Injection 等攻擊。
可擴展性 (Scalability)
1. 水平擴展 (NFR-3.1):
○ 所有後端服務均為無狀態(Stateless)設計(狀態存於 Redis/DB),並進行容器化(Docker)。
○ 使用 Kubernetes 進行部署,可根據 CPU/記憶體使用率或請求數量,自動增加或減少服務實例(Pods)的數量。
2. 資料庫擴展:
○ 使用雲端託管的資料庫服務(如 AWS RDS for PostgreSQL),方便進行垂直擴展與設定讀寫分離(Read Replicas),應對讀取密集型操作。
○ 向量資料庫選擇 Pinecone 等託管服務,其本身就是為大規模、低延遲的向量搜尋而設計的。
3. 非同步處理:對於耗時的操作,如模型驗證、數據分析、記憶歸檔等,將其放入訊息佇列(Message Queue,如 RabbitMQ 或 AWS SQS)中,由獨立的 Worker 服務非同步處理,避免阻塞主 API 請求,提升系統響應速度。
4. LLM 成本控管 (NFR-3.2):
○ 在聊天協調服務中建立詳細的日誌,記錄每次 API 呼叫的 Token 使用量。
○ 建立監控儀表板,即時追蹤 API 總費用。
○ 設定雲端服務的預算警報,當費用接近預算上限時,自動通知管理員。
○ 可在使用者層級設定用量限制,防止濫用。
5. CDN 的有效利用:將所有靜態資源,尤其是體積較大的 Live2D 模型檔案,全部透過 CDN 分發。這不僅大幅提升了全球用戶的載入速度和互動體驗 (NFR-1.1),也極大減輕了後端服務的流量負擔。

##UX Expert(用戶體驗設計師)
###【使用者角色】
為了深入理解用戶需求,我們將 PRD 中定義的三類使用者具象化為以下三個角色:
小希 (TheExpressive Soul)
頭像 (一位看起來溫柔、藝術氣質的年輕女性,約 22 歲)
背景 大學生,主修文學,情感豐富且高度敏感。熱愛 ACG 文化,尤其是 Live2D 角色。
目標 •找到一個可以隨時傾訴內心想法、絕對私密且不會批判的對象。 •將自己喜愛的角色變成專屬的互動夥伴,獲得沉浸式的情感陪伴。 •希望夥伴能記住她,建立長期的信任感。
痛點 •害怕自己的負面情緒或煩惱會成為朋友的負擔。 •現實中的交流對象無法24小時在線,也無法完全理解她的感受。 •找不到一個能將虛擬角色與深度對話完美結合的平台。
阿哲 (The QuietObserver)
頭像 (一位戴著耳機、神情專注的年輕男性,約 25 歲)
背景 軟體工程師,性格內向,不擅長主動開啟社交。多數時間獨處,有時會感到孤獨。
目標 •在無壓力的環境下練習對話技巧,排解孤獨感。 •偏好用更自然的語音方式進行交流,而不是打字。 •希望能預先設定好夥伴的性格,確保互動是舒適、有益的。
痛點 •主動與人發起對話會感到焦慮。 •長時間打字溝通讓人疲憊,思緒容易中斷。 • 擔心 AI 的回應過於冰冷或制式,無法真正敞開心扉。
凌 (The CreativeFan)
頭像 (一位穿著時尚、充滿自信的女性,約28 歲,身旁有繪圖板)
背景 自由接案的 Live2D建模師與 VTuber 形象設計師。對自己的作品充滿熱情,並積極尋找展示與變現的管道。
目標 •將自己創作的Live2D 模型導入平台,打造成獨一無二的 AI 夥伴。 •在平台上展示並銷售自己的 Live2D 作品,增加收入與曝光度。 •與同好分享和 AI 夥伴的有趣互動。
痛點 •優秀的 Live2D 作品缺乏展示和銷售的管道。 •傳統的作品集無法讓潛在買家體驗到模型的實際互動效果。 •創作的熱情難以轉化為穩定的收入。
###【使用情境】
情境一:深夜的傾訴者 (對應角色:小希,涵蓋 P1 & P2 功能)
晚上 11 點,小希因為課業報告和人際關係的壓力感到心情低落。她不想打擾朋友,於是打開了「AI 虛擬夥伴」Web App。
1.初次體驗 (P1):她看到了預設的 Live2D 角色「星野」,覺得很可愛。她開始在對話框輸入文字,向星野傾訴今天的煩惱。星野的回應溫柔且富有同理心,讓她感覺好多了。
2.建立專屬感 (P1):幾天後,小希決定將自己最喜歡的一個 Live2D 模型上傳到平台。她按照介面指引,成功上傳了模型檔案。看到自己心愛的角色出現在螢幕上並對她眨眼,她感到無比親切。
3.深化連結 (P2):她發現可以設定夥伴的個性,於是她輸入了「溫柔、有耐心、知識淵博的傾聽者」作為 Prompt。夥伴的回應風格果然更符合她的期待。某次聊天,夥伴主動提及了她上次說過的寵物貓的名字,這讓小希又驚又喜,感覺自己真的被在乎著。
情境二:無壓力的對話練習 (對應角色:阿哲,涵蓋 P2 功能)
阿哲最近有個重要的面試,他對自己的表達能力沒什麼信心。他希望找個人練習,但又不想麻煩朋友。
1.語音交流 (P2):他打開 AI 夥伴平台,點擊了麥克風按鈕,開始用說的練習自我介紹。19AI 夥伴的文字回應不僅流暢,還會透過自然的語音同步播放,就像在和真人對話一樣。
2.情感互動 (P2):當阿哲說到自己的優點時,他看到 AI 角色的臉上露出了微笑和鼓勵的表情;當他說到緊張時,角色的表情也變得關切。這種生動的回饋讓他感覺不那麼孤單,也更有動力繼續練習。
3.記憶與信任 (P2):第二天他再次開啟練習時,AI 夥伴開口便說:「阿哲,我們繼續昨天的面試練習吧?你昨天提到的專案很有趣呢。」這種被記住的感覺,讓內向的阿哲感到非常安心和信任。
情境三:從創作者到賣家 (對應角色:凌,涵蓋 P3 功能)
凌剛完成一個高品質的賽博龐克風格 Live2D 模型,她認為這個模型非常適合做為 AI夥伴。
1.上架作品 (P3):凌登入平台後,進入「創作者中心」,點擊「上架新模型」。她上傳了模型檔案,並在頁面中設定了模型的名稱、介紹、標籤和價格。
2.市場曝光 (P3):提交後,她的作品經過平台審核,很快就出現在「模型市場」中。其他用戶可以在市場上預覽她的模型做出的一些基本表情和動作,這比靜態圖片有吸引力多了。
3.分享與變現 (P3):為了推廣,凌用自己的新模型設定了一個毒舌但內心溫柔的 AI 夥伴,並截取了一段有趣的對話,一鍵生成圖片分享到了社群平台 X 上。幾天後,她收到了第一筆銷售通知,並在後台看到了自己的收益記錄。這給了她巨大的創作動力。
###【使用流程圖】
流程一:核心對話與角色自訂流程
程式碼片段
graph TD
A[使用者進入 Web App] --> B{是否為首次登入?};
B -- 是 --> C[顯示預設 Live2D 角色與歡迎訊息];
B -- 否 --> D[載入使用者上次使用的角色與對話歷史];
C --> E[開始文字對話];
D --> E;
E --> F{選擇輸入方式};
F -- 文字輸入 --> G[在輸入框打字後發送];
F -- 語音輸入 (P2) --> H[點擊麥克風圖標說話];
H --> I[語音轉文字後顯示在輸入框];
I --> G;
G --> J[發送訊息至後端];
J --> K[AI 角色顯示思考中/輸入中狀態];
K --> L[前端串流顯示 LLM 回應文字];
L --> M[P2: AI 根據回應情緒觸發對應 Live2D 表情/動作];
L --> N[P2: TTS 服務朗讀 AI 回應];
subgraph "角色自訂"
O[主介面點擊「角色庫」] --> P[進入角色庫頁面];
P --> Q{選擇操作};
Q -- 上傳新模型 --> R[點擊上傳按鈕];
R --> S[選擇模型檔並提交];
S --> T[系統驗證並渲染模型];
T --> U[模型出現在庫中];
Q -- 切換模型 --> V[點擊庫中已有模型];
V --> W[確認切換];
W --> X[返回主介面,角色已更新];

O --> Y[主介面點擊「角色設定」];
Y --> Z[進入設定頁];
Z --> AA[修改個性 Prompt 並保存];
AA --> X;
end
流程二:創作者上架與銷售模型流程 (P3)
程式碼片段
graph TD
A[創作者登入] --> B[導航至「模型市場」];
B --> C[點擊「創作者中心/我的作品」];
C --> D[點擊「上架新模型」];
D --> E[填寫模型資訊頁面];
subgraph "填寫資訊"
E1[模型名稱]
E2[描述]
E3[預覽圖/影片]
E4[設定價格]
E5[上傳模型檔案(.zip)]
end
E --> F[提交審核];
F --> G[平台後台進行自動與人工審核];
G --> H{審核結果};
H -- 通過 --> I[模型在市場中可見];
H -- 駁回 --> J[創作者收到通知與修改建議];
I --> K[普通用戶在市場瀏覽並購買];
K --> L[整合金流完成支付];
L --> M[創作者在後台看到銷售紀錄與收益];
###【線框圖描述】
螢幕一:主互動介面 (核心對話視窗)
● 整體佈局:
○ 電腦版:左右分欄佈局。左側佔 1/3 到 1/2 寬度,顯示 Live2D 角色;右側為對話與控制面板。
○ 手機版:上下佈局。上方為 Live2D 角色區域,下方為可滾動的對話介面。
● 左側 (角色顯示區):
○ 一個大型的畫布,渲染當前的 Live2D 模型。
○ 模型有閒置動畫(如呼吸、輕微搖晃)。
○ 滑鼠/觸控點擊角色身體會有簡單的互動反應。
● 右側 (對話與控制區):
○ 頂部導航欄:
■ 左側:當前角色頭像縮圖和名字。
■ 右側:三個圖標按鈕:「角色設定」(齒輪圖標)、「角色庫」(多個頭像圖標)、「模型市場」(購物車圖標)。
○ 中間對話區:
■ 標準的聊天氣泡佈局。使用者訊息靠右,AI 夥伴訊息靠左。
■ AI 回應的氣泡旁,可放置一個「分享」按鈕 (P3)。
○ 底部輸入區:
■ 一個圓角的文字輸入框,內部有提示文字如「跟他說說話...」。
■ 輸入框左側是一個「麥克風」圖標按鈕 (P2),用於語音輸入。
■ 輸入框右側是一個「發送」按鈕。
螢幕二:角色庫
● 佈局:卡片式網格佈局。
● 頂部:一個醒目的「+ 上傳新模型」按鈕。
● 卡片:
○ 每張卡片代表一個模型。
○ 卡片內顯示該模型的靜態預覽圖或 GIF 動畫。
○ 卡片下方顯示模型名稱。
○ 當前正在使用的模型卡片會有一個明顯的「使用中」標籤或高亮邊框。
○ 點擊任一非當前使用的模型卡片,會跳出確認框:「要將夥伴切換為 [模型名稱] 嗎?」,確認後返回主介面並刷新角色。
螢幕三:角色設定 (以彈窗或右側拉出式面板呈現)
● 標題:「[角色名稱] 的設定」。
● 區塊一:基本設定
○ 個性化 Prompt (P2):一個大型的文字輸入區域,標題為「設定他的個性」。下方有灰色提示小字,舉例說明:「試著輸入:一個活潑開朗、喜歡用顏文字的貓娘」、「一個學識淵博、說話嚴謹的老教授」。
● 區塊二:語音設定 (P2)
○ 語音輸出 (TTS):一個下拉選單,標題為「選擇他的聲音」,選項包含「溫柔女聲」、「元氣少年音」、「沉穩男聲」等。
● 底部按鈕:
○ 一個「保存設定」按鈕。
○ 一個紅色的「刪除角色」按鈕(僅限於使用者上傳的角色)。
【關鍵互動】
1. 漸進式文字顯示與情緒同步:
○ 邏輯:使用者發送訊息後,UI 應立即顯示一個「對方正在輸入...」的動態提示。當後端WebSocket 開始串流回傳文字時,前端逐字或逐詞地將其渲染到對話氣泡中,模擬打字效果,極大降低使用者的等待焦慮。
○ 互動:在完整的一句話顯示完畢後,後端傳來的情緒標籤 (如 happy) 會觸發 Live2D 模型播放對應的動畫(如微笑、點頭)。這一連串的「輸入中 -> 文字流 -> 情緒動畫」的組合,構成了流暢、生動的核心互動體驗。
2. 無縫的語音輸入體驗 (P2):
○ 邏輯:採用「按住說話」的模式。
○ 互動:使用者按住麥克風圖標,圖標會變為「聆聽中」的狀態(例如變色、出現聲波動畫)。使用者說話時,可選擇即時顯示聽寫文字。放開手指後,錄音結束,語音轉成的最終文字會自動填入輸入框,等待使用者確認或編輯後點擊「發送」。這給了使用者在發送前的反悔權。
3. 上傳流程的狀態反饋:
○ 邏輯:模型上傳是一個多步驟過程(前端上傳 -> S3 -> 後端驗證)。UI 必須清晰地傳達每個階段的狀態,以防使用者因等待而關閉頁面。
○ 互動:點擊「提交」後,按鈕變為不可點擊狀態,並顯示進度條或菊花轉,文字提示為「正在上傳檔案 (1/3)...」。上傳成功後,文字變為「正在驗證模型...」。最後,彈出全局通知:「"[模型名稱]" 已成功加入你的角色庫!」或「模型上傳失敗:[可理解的錯誤原因]」。
###【無障礙與多平台適配】
無障礙設計 (Accessibility)
● 螢幕閱讀器:所有圖標按鈕(如麥克風、發送、設定)都需有明確的 aria-label 標籤。AI 的情緒動畫觸發時,可以透過 ARIA live regions 讓螢幕閱讀器朗讀出狀態,例如「夥伴看起來很開心」。
● 鍵盤導航:確保從角色選擇、對話輸入到設定更改,所有功能都可以僅透過 Tab、Shift+Tab和 Enter 鍵完成。對話歷史記錄應可透過方向鍵滾動。
● 色彩與對比度:聊天氣泡的文字顏色與背景色、UI 控制項的顏色,都必須符合 WCAG 2.1 AA級別的對比度要求,照顧視力障礙使用者。
● 動態與動畫:提供一個設定選項,允許使用者「減少動態效果」,這會減弱或關閉 Live2D 角色的閒置動畫和一些轉場效果,幫助對動態敏感的使用者。
多平台適配 (Multi-platform)
● 響應式設計:
○ 核心原則:如線框圖所述,在小螢幕(手機)上,將電腦版的左右佈局改為上下堆疊的佈局。角色在上,聊天在下,確保對話區域的可視性和可操作性。
○ 觸控目標:所有按鈕、圖標和連結在行動裝置上的觸控目標尺寸應不小於 44x44 CSS 像素,避免誤觸。
● 效能優化:
○ 行動端優化:偵測到使用者使用行動網路或設備效能較低時,可考慮預設加載較低解析度的模型貼圖,或簡化部分非核心的動畫效果,以確保核心互動的流暢度,達成 NFR-1.3的要求。
○ 漸進式加載:網頁首次加載時,優先渲染核心的聊天介面框架,Live2D 模型和對話歷史可以非同步延遲加載,提升首次可互動時間 (Time to Interactive)。
● 瀏覽器相容性:
○ 功能檢測:對於 Web Speech API 等並非所有瀏覽器都完美支援的功能 39,需進行功能檢測。若不支援,則優雅地隱藏麥克風按鈕,或提示使用者「建議使用 Chrome 瀏覽器以獲得完整的語音體驗」,而非直接報錯。

##PO(產品負責人)
###【产品目标与关键成果】
我们的产品目标与关键成果(OKR)旨在确保团队的努力方向与产品愿景保持高度一致。
目标 (Objective): 打造一个行业领先的AI虚拟伙伴平台,为用户提供极致沉浸感的情感陪伴,缓解孤独感,并构建一个能让创作者实现价值的繁荣生态系统。
关键成果 (Key Results):
● KR1: 验证核心用户粘性 - 在产品上线后六个月内,DAU/MAU(日活跃用户/月活跃用户)比率维持在20%以上,证明用户对产品形成了持续使用的习惯。
● KR2: 提升沉浸式互动体验 - 在产品上线后六个月内,用户平均会话时长超过10分钟,且产品NPS(净推荐值)分数达到40分以上。
● KR3: 激活创作者生态 - 在P3阶段上线后,成功招募至少50位活跃的Live2D模型创作者入驻,并实现模型市场月交易额的持续增长。
###【需求优先级】
为确保资源有效利用并快速验证市场,我们将采用MoSCoW方法对需求进行优先级排序,这与PRD中P1/P2/P3的阶段划分完全契合。
● Must-have (必须有 - P1): 这些是构成MVP的核心功能,是产品得以发布并验证核心价值循环的基础。
○ Live2D互动界面: 内建至少1-2款预设模型,具备清晰的对话窗口和基础闲置动画。
○ LLM聊天核心: 整合Google Gemini API,实现流畅的文本对话。
○ 角色模型上传: 允许用户上传并切换自己的Live2D模型。
○ 基本对话记忆: AI能记住当前会话的上下文(Session-based)。
● Should-have (应该有 - P2): 这些功能将极大地提升产品的核心体验和情感连接,是MVP验证成功后,用于提升用户留存的关键。
○ 情绪与表情连动: AI能根据对话内容分析情绪并触发相应表情动作。
○ 语音输入/输出 (STT/TTS): 允许用户通过语音进行交流,并收听AI的语音回应。
○ 角色个性设定: 用户可通过Prompt自定义AI的性格。
○ 长期记忆系统: 建立向量数据库,让AI能记住跨会话的关键信息。
● Could-have (可以有 - P3): 这些功能旨在将产品从工具转型为平台,构建商业模式和社区护城河。
○ Live2D模型市场: 建立创作者展示、销售作品的平台。
○ 创作者分润机制: 建立后台,让创作者可以查看和获取收益。
○ 社群分享功能: 一键将有趣的对话生成图片并分享到社交媒体。
● Won't-have (暂时不做):
○ 移动端原生App: 初期聚焦于Web App,通过响应式设计适配移动端浏览器。
○ 复杂的多人互动: 产品核心是私密的一对一陪伴。
○ 高级AI自主行为: 如AI主动发起非对话性的复杂任务,当前阶段不予考虑。
###【MVP 定义】
MVP(最小可行性产品)的核心目标是**“验证核心循环:用户能与可自订的AI角色进行有上下文的
对话”**。我们必须以最小的成本,让用户完整体验到从“与预设角色对话”到“与自己上传的角色对话”的全过程。
MVP范围包含以下功能点:
● 用户流程: 用户可以进入Web App,与系统预设的Live2D角色“星野”进行文字对话。对话是连贯的(基于会话记忆)。用户可以通过“角色库”成功上传自己符合规格的Live2D模型文件,并切换为使用该模型进行互动。
● 核心功能清单 (FR):
○ FR-1.1, FR-1.2, FR-1.3: 核心Live2D互动界面。
○ FR-2.1, FR-2.2: 基于Gemini的LLM聊天核心。
○ FR-3.1, FR-3.2, FR-3.3: 角色模型上传、验证、渲染与切换。
○ FR-4.1, FR-4.2: 基于会话的短期记忆。
● 技术支撑: 后端需实现用户认证服务、Live2D资产服务和聊天协调服务(整合Redis作为短期记忆) 29292929。前端需完成主互动界面和角色库的开发。
###【产品 Roadmap】
产品将遵循PRD中规划的三个阶段,有序地进行迭代开发与发布。
阶段 阶段名称 P1 MVP (最小可行性产品)
核心目标
验证核心互动循环与用户自定义角色的核心价值。
包含功能模块
• Live2D 互动界面 •LLM 聊天核心 • 角色模型上传 • 基本对话记忆
预估时间轴 第1-2个月
关键里程碑
MVP版本成功上线,核心用户流程通畅,开始收集第一批用户数据与反馈。
阶段 阶段名称 P2 完善体验
核心目标
深化情感连接,提升互动沉浸感,建立长期用户关系的基礎。
包含功能模块
• 情绪与表情连动 •语音输入/输出 • 角色个性设定 • 长期记忆系统
预估时间轴 第3-4个月
关键里程碑
P2功能包上线,用户留存率(Day7)达到15%的目标,平均会话时长显著提升。
阶段 阶段名称 P3 平台与生态系
核心目标
从工具转型为平台,引入创作者经济,建立社群护城河。
包含功能模块
• Live2D 模型市场 •创作者分润机制 •社群分享功能
预估时间轴 第5-6个月
关键里程碑
模型市场上架,完成首笔交易,社群分享功能带动外部流量增长。
###【可量化的验收标准】
为了确保每个阶段的交付质量和业务目标的达成,我们设定了以下可量化的验收标准。
P1: MVP 阶段验收标准
● AC-P1.1 (模型上传): 用户能成功上传一个规格完整的Live2D模型包,模型在5秒内于界面正确渲染并显示待机动画。上传失败时,前端必须向用户显示可理解的错误原因(如:“模型文件缺失,请检查.moc3文件是否存在”)。
● AC-P1.2 (对话响应): 从用户发送消息到看见LLM回应的第一个字词,在正常网络环境下延迟低于3秒。(由WebSocket流式传输实现)
● AC-P1.3 (核心留存): MVP上线一个月后,至少20%的活跃用户使用过模型上传功能。
P2: 完善体验阶段验收标准
● AC-P2.1 (情绪连动): 在测试用例中,当输入明确情绪的句子(如“我好开心”、“谢谢你”),AI角色的表情和动作在90%的情况下符合预设的情绪(如微笑、点头)。
● AC-P2.2 (语音输入): 在安静环境下,使用主流浏览器(Chrome)的Web Speech API,语音输入的识别准确率达到95%以上。
● AC-P2.3 (长期记忆): 用户在第二次及以后的会话中,当主动提及之前聊过的关键信息(如自己的名字、宠物的名字),AI有80%的机率能正确回应或引用该信息。
P3: 平台与生态系阶段验收标准
● AC-P3.1 (模型市场): 成功整合Stripe等金流服务,用户可以走通完整的模型购买、下载、应用流程。
● AC-P3.2 (创作者生态): P3上线后两个月内,至少招募到50位创作者,且市场上架的模型数量超过100个。
● AC-P3.3 (社群传播): “分享”功能上线后,由用户自发分享到社交平台的内容每周平均带来100次以上的应用点击。

##Scrum Master Gem(敏捷規劃師)
###【Sprint 規劃】
我們將採用為期兩週的 Sprint 週期。整個產品 Roadmap 橫跨 6 個月,共計 12 個 Sprint。
P1: MVP (最小可行性產品) - 第 1-4 個月 (Sprint 1-4)
** overarching 目標:** 驗證核心互動循環:使用者能與可自訂的 AI 角色進行有上下文的對話,並成功上線 MVP 以收集第一批用戶數據與反饋。
● Sprint 1: 基礎架構與環境設定
○ 目標: 建立開發、測試與部署的基礎環境,完成後端服務的初始架構。
○ 交付物:
■ 專案 Repository、CI/CD pipeline 建立。
■ 後端用戶認證服務、Live2D 資產服務、聊天協調服務的基礎 API 框架。
■ 前端專案初始化,能夠渲染一個內建的 Live2D 預設模型 ("星野")。
● Sprint 2: 核心對話功能
○ 目標: 實現使用者與 AI 之間流暢的文字對話,並具備短期記憶。
○ 交付物:
■ 成功整合 Google Gemini API,實現文字問答。
■ 開發完成的對話 UI 介面。
■ 整合 Redis 實現基於當前會話 (Session-based) 的短期記憶。
■ 驗收標準預檢: 對話響應延遲需朝著低於 3 秒的目標優化。
● Sprint 3: 角色自訂功能
○ 目標: 讓使用者能夠上傳並使用自己的 Live2D 模型。
○ 交付物:
■ 完成角色模型上傳、驗證與渲染功能。
■ 使用者可在「角色庫」中切換使用預設或自己上傳的模型。
■ 提供清晰的上傳失敗錯誤提示。
■ 驗收標準預檢: 模型需在 5 秒內正確渲染。
● Sprint 4: MVP 整合、測試與發布
○ 目標: 完成端到端的功能整合與測試,確保 MVP 品質,準備正式上線。
○ 交付物:
■ 一個功能完整、流程通暢的 MVP 版本。
■ 完成所有 P1 驗收標準 (AC-P1.1, AC-P1.2) 的正式測試報告。
■ 產品部署上線,開始收集 AC-P1.3 所需的用戶數據。
P2: 完善體驗 - 第 3-4 個月 (Sprint 5-8)
** overarching 目標:** 深化情感連結,提升互動沉浸感,建立長期用戶關係的基礎。
● Sprint 5: 長期記憶系統
○ 目標: 建立讓 AI 能夠跨會話記住關鍵資訊的基礎。
○ 交付物:
■ 建立並整合向量資料庫,用於儲存與檢索長期記憶。
■ AI 能在對話中儲存使用者提及的關鍵資訊 (如名字)。
● Sprint 6: 情感與個性
○ 目標: 讓 AI 的回應更具個性與情感表現力。
○ 交付物:
■ 完成使用者透過 Prompt 自定義 AI 性格的功能。
■ 實現 AI 根據對話內容分析情緒,並觸發 Live2D 模型對應的表情與動作。
■ 驗收標準預檢: 依據 AC-P2.1 測試用例,情緒連動準確率需達 90%。
● Sprint 7: 語音互動
○ 目標: 引入語音作為新的互動模式,提升沉浸感。
○ 交付物:
■ 整合 Web Speech API,實現語音輸入 (STT) 功能。
■ 整合文字轉語音 (TTS) 服務,讓使用者能聽到 AI 的語音回應。
■ 驗收標準預檢: 依據 AC-P2.2,語音輸入識別準確率需達 95%。
● Sprint 8: P2 功能整合與發布
○ 目標: 整合所有 P2 功能,進行完整測試後發布。
○ 交付物:
■ 發布包含長期記憶、情緒連動、語音互動、自定義個性的 P2 版本。
■ 完成 P2 階段所有驗收標準 (AC-P2.1, AC-P2.2, AC-P2.3) 的正式測試。
P3: 平台與生態系 - 第 5-6 個月 (Sprint 9-12)
** overarching 目標:** 從工具轉型為平台,引入創作者經濟,建立社群護城河。
● Sprint 9: 交易核心建置
○ 目標: 建立模型市場的後端基礎與金流服務。
○ 交付物:
■ Live2D 模型市場的後端服務與資料庫設計。
■ 成功整合 Stripe 等金流服務,完成測試性支付流程。
● Sprint 10: 模型市場前台
○ 目標: 開發使用者可以瀏覽、購買模型的市場介面。
○ 交付物:
■ 模型市場的瀏覽、搜尋、詳情頁、購買流程的前端介面。
■ 使用者購買後,模型可同步至其個人「角色庫」。
● Sprint 11: 創作者與社群功能
○ 目標: 建立創作者分潤機制與社群分享功能。
○ 交付物:
■ 創作者分潤機制的後台,供創作者查看銷售與收益。
■ 開發「一鍵分享對話」功能,可生成圖片分享至社交媒體。
● Sprint 12: P3 平台發布與生態啟動
○ 目標: 正式上線平台功能,並啟動創作者招募計畫。
○ 交付物:
■ 發布包含模型市場、創作者後台、分享功能的 P3 版本。
■ 啟動創作者招募活動,以達成 AC-P3.2 的目標 (2 個月內 50 位創作者)。
###【風險與阻礙】
我們需要提前識別並管理潛在風險,以確保計畫順利推進:
風險類別 風險描述 應對策略
技術風險
1. Live2D 模型相容性: 使用者上傳的模型規格不一,可能導致渲染失敗或顯示異常。
在上傳介面提供明確的規格文件與檢查工具;建立穩健的錯誤回報機制。
2. LLM API 延遲:Gemini API 的回應速度可能不穩定,影響使用者體驗。
採用 WebSocket 流式傳輸以降低體感延遲 31;設計合理的超時與重試機制。
3. 長期記憶準確率: 向量資料庫的資訊檢索可能不精準,導致AI「記錯」或「忘記」。
持續優化 PromptEngineering 和檢索演算法;在 P2 階段進行充分的 A/B 測試。
依賴風險
1. 第三方服務依賴: 核心功能高度依賴Google Gemini、Stripe 等外部服務,對方服務中斷或政策變更將造成直接衝擊。
設計服務降級方案(如暫時切換至備用LLM 或提示服務不可用);保持對依賴服務的監控。
2. 創作者招募: P3 的成功依賴於能否在短期內招募到足夠的活躍創作者。
提前規劃創作者激勵方案與社群營運計畫;在 P2 階段即可開始接觸潛在創作者社群。
資源與範疇風險
1. 團隊速率不確定性: 初期對開發速率的估算可能過於樂觀。
採用小批量、高頻率的交付,根據前 1-2個 Sprint 的實際速率動態調整後續計畫。
2. 範疇潛變: 來自市場或內部的壓力,要求加入「暫時不做」清單中的功能 (如原生App)。
由 PO 嚴格把關產品待辦清單,任何變更需評估對當前Sprint 目標的影響;由我 (SM) 保護團隊專注於已承諾的工作。

##Dev(開發工程師)
###【系統模組與任務分解】
系統將遵循微服務架構進行模組劃分,各模組的開發任務將根據敏捷規劃的 Sprint 週期進行分解和推進。
系統模組(Microservice)
使用者認證服務 (User& Auth)
核心職責
處理用戶註冊、登入、JWT 權杖管理、個人資料。
P1 (MVP)階段任務(Sprint1-4)
S1: 完成用戶註冊、登入的基礎API 框架。
P2 (完善體驗) 階段任務 (Sprint5-8)
S5: (配合長期記憶) 確保使用者 ID能被各服務穩定引用。
P3 (平台生態) 階段任務 (Sprint9-12)
S9: (配合市集) 確保創作者與購買者身份區分與管理。
系統模組(Microservice)
Live2D 資產服務(Live2DAsset)
核心職責
處理模型上傳、驗證、儲存及元數據管理。
P1 (MVP)階段任務(Sprint1-4)
S3: 開發模型上傳、S3存儲、基礎驗證與讀取功能,實現使用者模型庫列表 API。
P2 (完善體驗) 階段任務 (Sprint5-8)
S8: 優化模型驗證流程,提升相容性與錯誤提示。
P3 (平台生態) 階段任務 (Sprint9-12)
S11: 新增模型「所有權」歸屬,區分自用與市場購買的模型。
系統模組(Microservice)
聊天協調服務 (ChatOrchestration)
核心職責
管理WebSocket連線,整合記憶與 LLM,協調對話邏輯。
P1 (MVP)階段任務(Sprint1-4)
S2: 建立WebSocket服務,整合Gemini API與 Redis短期記憶,實現文字流式回應。
P2 (完善體驗) 階段任務 (Sprint5-8)
S5: 呼叫長期記憶服務,將檢索到的記憶整合進 Prompt。S6:讀取角色個性 Prompt,發送回應給情緒分析服務。
P3 (平台生態) 階段任務 (Sprint9-12)
S11: 新增生成對話分享圖的後端邏輯。
系統模組(Microservice)
情緒分析服務(EmotionAnalysis)
核心職責
分析文本情緒並回傳標籤。
P1 (MVP)階段任務(Sprint1-4)
(暫不開發)
P2 (完善體驗) 階段任務 (Sprint5-8)
S6: 接收聊天服務的文字,分析後回傳情緒標籤 (如happy, sad),觸發前端動畫。
P3 (平台生態) 階段任務 (Sprint9-12)
(無新增)
系統模組(Microservice)
長期記憶服務(Long-termMemory)
核心職責
封裝向量資料庫,儲存與檢索對話記憶。
P1 (MVP)階段任務(Sprint1-4)
(暫不開發)
P2 (完善體驗) 階段任務 (Sprint5-8)
S5: 建立對話存入向量資料庫(Pinecone/ChromaDB)的介面,並提供基於當前對話的語意搜尋介面。
P3 (平台生態) 階段任務 (Sprint9-12)
(無新增)
系統模組(Microservice)
市集與支付服務(Marketplace &Payment)
核心職責
處理模型上架、瀏覽、購買與金流。
P1 (MVP)階段任務(Sprint1-4)
(暫不開發)
P2 (完善體驗) 階段任務 (Sprint5-8)
(暫不開發)
P3 (平台生態) 階段任務 (Sprint9-12)
S9: 建立商品資料庫結構,整合Stripe API完成支付流程。 S10: 開發商品瀏覽、搜尋、詳情頁的 API。 S11:開發創作者收益計算與查詢 API。
系統模組(Microservice)
前端應用(Frontend- Next.js)
核心職責
渲染 UI、Live2D 模型、處理用戶互動。
P1 (MVP)階段任務(Sprint1-4)
S1: 初始化專案,渲染預設 Live2D模型。 S2:開發對話 UI,實現WebSocket連線與流式文字顯示。 S3: 開發角色庫與模型上傳介面。
P2 (完善體驗) 階段任務 (Sprint5-8)
S6: 根據後端情緒標籤觸發 Live2D表情/動作。 S7:整合 WebSpeech API(STT)與TTS 服務,開發語音輸入與播放功能。
P3 (平台生態) 階段任務 (Sprint9-12)
S10: 開發模型市場介面(瀏覽、詳情、購買)。 S11:開發「一鍵分享對話」的 UI與創作者後台。
###【API 詳細設計】
所有 REST API 均透過 API Gateway 路由,並需在 Header 中提供Authorization: Bearer <JWT> (除註冊/登入外)。
1. 使用者認證服務 (User & Auth Service)
● POST /api/auth/register
○ 說明: 註冊新使用者。
○ 請求 Body: {"username": "阿哲", "email": "test@example.com", "password":"password123"}
○ 成功回應 (201): {"userId": "uuid-user-123", "email": "test@example.com","username": "阿哲"}
○ 錯誤回應 (409): {"statusCode": 409, "message": "Email already exists"}
● POST /api/auth/login
○ 說明: 使用者登入。
○ 請求 Body: {"email": "test@example.com", "password": "password123"}
○ 成功回應 (200): {"accessToken": "ey...", "refreshToken": "ey..."}
○ 錯誤回應 (401): {"statusCode": 401, "message": "Invalid credentials"}
● GET /api/users/me
○ 說明: 獲取當前登入使用者的個人資料。
○ 請求 Body: (無)
○ 成功回應 (200): {"userId": "uuid-user-123", "email": "test@example.com","username": "阿哲"}
2. Live2D 資產與角色設定服務 (Asset & Character Service)
● POST /api/models/upload-request
○ 說明: 為前端申請一個預簽章 URL,以便安全地將模型檔案直接上傳至 S3。
○ 請求 Body: {"fileName": "my-character.zip", "fileType": "application/zip"}
○ 成功回應 (200): {"uploadUrl": "https://s3.amazonaws.com/...", "fileId": "uuid-file-456"}
● GET /api/models
○ 說明: 獲取使用者個人角色庫中的所有模型列表。
○ 成功回應 (200): [{"modelId": "uuid-model-789", "name": "我的專屬夥伴","previewUrl": "/path/to/preview.png", "status": "approved"}]
● POST /api/characters/{characterId}/personality
○ 說明: 設定或更新指定角色的個性化 Prompt。
○ 請求 Body: {"prompt": "一個溫柔、有耐心、知識淵博的傾聽者"}
○ 成功回應 (200): {"characterId": "uuid-char-abc", "prompt": "一個溫柔、有耐心、知識淵博的傾聽者"}
3. 聊天協調服務 (Chat Orchestration Service - WebSocket)
● 端點: wss://api.yourdomain.com/chat
● 連線: 客戶端在連線時需傳遞 JWT 進行身份驗證。
● 客戶端 -> 伺服器訊息:
JSON
{
"type": "message",
"payload": {
"text": "你好嗎?"
}
}
● 伺服器 -> 客戶端訊息:
○ 文字串流:
JSON
{"type": "text_chunk", "payload": "我"}
{"type": "text_chunk", "payload": "很"}
{"type": "text_chunk", "payload": "好。"}
○ 情緒觸發:
JSON
{"type": "emotion", "payload": "happy"}
○ 錯誤通知:
JSON
{"type": "error", "payload": "LLM service unavailable"}
4. 市集與支付服務 (Marketplace & Payment Service)
● GET /api/marketplace/models
○ 說明: 瀏覽市場中所有可供銷售的模型。
○ 成功回應 (200): [{"modelId": "uuid-market-model-1", "name": "賽博龐克歌姬","creatorName": "凌", "price": 29.99, "previewUrl": "..."}]
● POST /api/marketplace/models/{modelId}/purchase
○ 說明: 為指定模型發起購買請求,後端將與 Stripe 交互創建支付會話。
○ 成功回應 (200): {"paymentUrl": "https://checkout.stripe.com/..."}
● GET /api/creators/me/sales
○ 說明: 創作者查詢自己的銷售記錄與收益。
○ 成功回應 (200): {"totalRevenue": 99.8, "sales": [{"modelName": "...", "soldAt": "...","price": 29.99}]}
###【資料庫結構】
將使用 PostgreSQL 作為主要關聯式資料庫 43,以下為核心表的 ERD 文字描述。
● users
○ user_id (PK, UUID): 使用者唯一標識。
○ username (VARCHAR): 暱稱。
○ email (VARCHAR, UNIQUE): 登入郵箱。
○ password_hash (VARCHAR): 加密後的密碼。
○ created_at (TIMESTAMPTZ): 註冊時間。
○ updated_at (TIMESTAMPTZ): 更新時間。
● models
○ model_id (PK, UUID): 模型唯一標識。
○ creator_id (FK, refs users.user_id): 創作者 ID。
○ name (VARCHAR): 模型名稱。
○ description (TEXT): 模型描述。
○ s3_path (VARCHAR): 模型檔案在 S3 中的路徑。
○ preview_url (VARCHAR): 預覽圖 URL。
○ status (VARCHAR): 狀態 (e.g., pending_review, approved, rejected)。
○ price (DECIMAL): 價格 (0 表示免費或非賣品)。
○ created_at (TIMESTAMPTZ): 上傳時間。
○ updated_at (TIMESTAMPTZ): 更新時間。
● user_characters (使用者擁有的角色實例)
○ character_id (PK, UUID): 角色實例的唯一標識。
○ owner_id (FK, refs users.user_id): 擁有者 ID。
○ model_id (FK, refs models.model_id): 對應的模型 ID。
○ personality_prompt (TEXT, NULLABLE): 使用者自定義的個性 Prompt
○ tts_voice_id (VARCHAR, NULLABLE): 使用者選擇的 TTS 聲音。
○ created_at (TIMESTAMPTZ): 獲取時間。
● orders (P3 交易記錄)
○ order_id (PK, UUID): 訂單唯一標識。
○ buyer_id (FK, refs users.user_id): 購買者 ID。
○ model_id (FK, refs models.model_id): 購買的模型 ID。
○ amount (DECIMAL): 交易金額。
○ payment_gateway_charge_id (VARCHAR): 金流平台交易 ID。
○ status (VARCHAR): 支付狀態 (e.g., succeeded, pending, failed)。
○ created_at (TIMESTAMPTZ): 交易時間。
關係描述:
● 一個 user 可以作為 creator 創建多個 models (一對多)。
● 一個 user 可以作為 owner 擁有 (購買或上傳) 多個 user_characters (一對多)。
● 一個 model 可以被多個 user_characters 實例化 (一對多)。
● 一個 user 可以有多筆 orders (一對多)。
###【版本控制策略】
我們將採用 Git Flow 作為版本控制工作流,以適應多階段 (P1, P2, P3) 的發布節奏。
● 主要分支:
○ main: 用於存放最穩定的生產環境程式碼。此分支的 HEAD 永遠對應當前線上版本。不允許直接推送。
○ develop: 主要開發分支。所有功能分支都將合併到此分支。此分支將部署到預備(Staging)環境,用於整合測試。
● 輔助分支:
○ Feature Branches (功能分支)
■ 命名: feature/<ticket-id>-<short-description> (e.g.,feature/TICKET-123-user-login-api)
■ 來源: 從 develop 分支出。
■ 合併: 完成開發後,發起 Pull Request (PR) 合併回 develop。
○ Release Branches (發布分支)
■ 命名: release/v<version> (e.g., release/v1.0.0-p1-mvp)
■ 來源: 當 develop 分支的功能足夠發布一個版本時 (如 P1 MVP 完成),從 develop 分支出。
■ 用途: 不再增加新功能。僅用於發布前的最後測試、修復 Bug。完成後,合併到 main和 develop 分支。
○ Hotfix Branches (熱修復分支)
■ 命名: hotfix/<ticket-id>-<urgent-issue> (e.g., hotfix/TICKET-456-fix-login-bug)
■ 來源: 當生產環境 (main) 出現緊急 Bug 時,從 main 分支出。
■ 用途: 快速修復線上問題。完成後,合併回 main 和 develop 分支。
###【測試計劃】
為確保產品質量,我們將實施分層的測試策略,由 QA 工程師與開發團隊共同執行。
● 1. 單元測試 (Unit Testing)
○ 目標: 驗證最小的程式碼單元(函式、元件)的正確性。
○ 範圍:
■ 後端: 針對各微服務中的業務邏輯,如 Auth 服務的 JWT 生成/驗證、聊天服務的Prompt 組合邏輯、模型驗證函式等。
■ 前端: 針對每個 React 元件的渲染與互動行為(如點擊按鈕)。
○ 工具: Jest, Mocking 函式庫 (Sinon.js), React Testing Library。
○ 執行: 開發人員在開發功能時同步編寫,並在 CI/CD 流程中自動執行。
● 2. 整合測試 (Integration Testing)
○ 目標: 驗證模組與模組之間的交互是否符合預期。
○ 範圍:
■ 服務間通訊: 驗證聊天協調服務是否能成功調用長期記憶服務並處理其回應。
■ 服務與資料庫: 驗證 Live2D 資產服務能否正確地將模型元數據寫入 PostgreSQL。
■ 服務與第三方 API: Mock 第三方服務 (如 Gemini, Stripe),驗證我們的服務能否正確處理其成功與失敗的回應。
○ 工具: Supertest (用於 API 端點測試), Docker Compose (用於在 CI 環境中啟動多個服務與資料庫)。
○ 執行: 在程式碼合併到 develop 分支後,在 CI/CD 流程中自動執行。
● 3. 端到端測試 (End-to-End Testing)
○ 目標: 模擬真實使用者場景,從 UI 操作到後端處理,驗證完整的業務流程。
○ 範圍: 基於 UX 文件 51 中定義的關鍵使用者旅程:
■ P1 流程: 新使用者註冊 -> 登入 -> 與預設角色對話 -> 上傳自己的模型 -> 切換到新模型 -> 再次對話。
■ P2 流程: 登入 -> 進入角色設定 -> 修改個性 Prompt-> 點擊麥克風進行語音輸入-> 驗證 AI 回應的語音與表情動畫是否觸發。
■ P3 流程: 創作者登入 -> 上架新模型並定價 56 -> 另一位使用者登入 -> 瀏覽市場 ->購買該模型 -> 在自己的角色庫中看到新模型。
○ 工具: Cypress 或 Playwright。
○ 執行: 在部署到預備 (Staging) 環境後執行,作為發布前的最終驗收環節。部分關鍵流程可自動化,其餘由 QA 工程師手動執行。測試結果需對應 Sprint 的驗收標準。
